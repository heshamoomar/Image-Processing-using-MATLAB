function [BW,maskedImage] = hand_segmentImage(RGB)
%segmentImage Segment image using auto-generated code from Image Segmenter app
%  [BW,MASKEDIMAGE] = segmentImage(RGB) segments image RGB using
%  auto-generated code from the Image Segmenter app. The final segmentation
%  is returned in BW, and a masked image is returned in MASKEDIMAGE.

% Auto-generated by imageSegmenter app on 04-May-2023
%----------------------------------------------------


% Convert RGB image into L*a*b* color space.
X = rgb2lab(RGB);

% Graph cut
foregroundInd = [89 90 91 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 305 306 307 309 310 327 328 522 523 531 546 739 740 755 764 957 958 982 983 1174 1176 1193 1201 1392 1413 1414 1419 1609 1612 1637 1826 1827 1830 1852 1855 2043 2044 2048 2059 2070 2073 2261 2274 2280 2291 2479 2509 2696 2720 2723 2727 2913 2914 2938 2941 3131 3137 3159 3162 3163 3349 3362 3373 3380 3566 3580 3598 3783 3784 3812 3816 4001 4034 4218 4219 4252 4436 4462 4470 4653 4654 4661 4679 4683 4687 4871 4892 4893 4905 5088 5089 5103 5110 5123 5306 5340 5341 5558 5768 5775 5989 5993 6197 6210 6211 6402 6416 6424 6428 6626 6646 6843 6864 7081 7264 7272 7299 7516 7517 7728 7734 7916 7924 7937 7952 8133 8134 8142 8167 8170 8351 8372 8388 8568 8569 8583 8605 8606 8785 8786 8793 8823 9002 9003 9027 9038 9041 9220 9259 9437 9438 9445 9476 9654 9655 9677 9687 9694 9872 9878 9905 9912 10089 10090 10129 10307 10344 10347 10524 10525 10529 10541 10565 10741 10742 10783 10959 10976 10982 11001 11177 11214 11219 11394 11420 11437 11611 11612 11616 11634 11647 11655 11828 11829 11847 11872 12046 12052 12090 12263 12270 12277 12279 12282 12284 12286 12302 12307 12480 12481 12494 12495 12506 12524 12698 12705 12707 12723 12741 12915 12923 12952 12958 12959 13132 13133 13138 13170 13176 13349 13350 13393 13567 13571 13587 13611 13784 13795 13805 13822 13829 14002 14040 14043 14046 14218 14219 14223 14261 14264 14435 14440 14473 14481 14482 14651 14652 14656 14657 14667 14699 14868 14869 14872 14917 15084 15085 15088 15089 15090 15124 15135 15300 15301 15302 15304 15305 15322 15341 15349 15353 15516 15517 15518 15520 15541 15570 15732 15734 15735 15788 15949 15951 15952 15979 16006 16167 16169 16198 16210 16224 16386 16416 16417 16441 16442 16602 16603 16604 16659 16821 16855 16858 16860 16861 16874 16877 17039 17091 17095 17257 17312 17313 17473 17475 17530 17693 17748 17909 17911 17966 18129 18184 18345 18347 18397 18402 18563 18565 18620 18783 18837 18999 19001 19055 19219 19220 19268 19273 19438 19491 19656 19709 19874 19921 19926 20089 20092 20139 20144 20310 20362 20528 20529 20575 20579 20580 20743 20745 20747 20797 20964 20965 21011 21015 21183 21229 21233 21401 21402 21447 21450 21619 21665 21668 21837 21839 21883 21886 22055 22104 22273 22275 22319 22322 22491 22540 22709 22758 22927 22973 22976 23145 23148 23194 23363 23412 23580 23581 23628 23630 23798 23802 23848 24016 24066 24234 24284 24451 24456 24501 24502 24669 24720 24887 24892 24938 25105 25156 25323 25328 25374 25375 25541 25592 25593 25594 25595 25759 25811 25977 25982 26029 26033 26195 26247 26252 26413 26465 26631 26636 26684 26849 26902 26907 27067 27120 27285 27290 27339 27343 27503 27557 27561 27721 27722 27726 27775 27940 27979 27980 27981 27982 27994 27997 28158 28197 28200 28201 28202 28212 28376 28380 28414 28415 28420 28421 28422 28431 28594 28598 28631 28633 28640 28641 28650 28812 28813 28816 28850 28859 28868 29031 29066 29068 29078 29087 29088 29249 29252 29286 29297 29305 29468 29470 29501 29504 29515 29523 29686 29722 29734 29742 29904 29909 29951 29952 29960 30123 30129 30154 30156 30157 30170 30179 30341 30347 30375 30389 30398 30559 30589 30593 30607 30616 30617 30778 30810 30811 30819 30826 30827 30833 30835 30996 31003 31025 31028 31046 31051 31054 31055 31215 31244 31245 31265 31274 31275 31276 31434 31441 31463 31484 31494 31495 31501 31502 31653 31654 31661 31680 31686 31692 31693 31704 31705 31714 31715 31716 31717 31718 31719 31720 31872 31873 31882 31896 31898 31909 31917 31924 31938 32092 32093 32102 32114 32120 32129 32143 32156 32312 32333 32334 32343 32347 32361 32374 32531 32532 32541 32559 32563 32564 32565 32566 32567 32580 32592 32751 32759 32767 32769 32777 32779 32796 32799 32809 32810 32970 32978 32980 32985 32986 32987 32993 32994 32995 32996 32997 32998 32999 33001 33003 33017 33027 33189 33199 33200 33202 33204 33219 33243 33244 33408 33409 33410 33420 33437 33439 33447 33449 33450 33451 33452 33453 33454 33461 33628 33629 33650 33654 33657 33661 33662 33663 33664 33672 33673 33679 33848 33849 33872 33875 33877 33878 33890 33891 33897 34067 34090 34093 34095 34104 34109 34115 34286 34287 34292 34305 34308 34312 34327 34333 34506 34510 34526 34530 34545 34551 34726 34727 34744 34748 34763 34770 34945 34947 34963 34966 34981 34988 35165 35166 35167 35181 35184 35206 35207 35385 35386 35399 35402 35425 35607 35615 35617 35621 35632 35643 35644 35826 35827 35836 35839 35862 36040 36054 36059 36081 36272 36278 36287 36299 36478 36518 36707 36709 36715 36737 36956 37140 37146 37153 37175 37354 37358 37364 37365 37372 37393 37590 37591 37594 37598 37600 37602 37604 37605 37612 37792 37793 37796 37797 37801 37811 37815 37824 37825 37826 37827 37831 38020 38029 38030 38031 38045 38046 38047 38049 38050 38232 38238 38239 38240 38245 38246 38251 38253 38265 38266 38268 38269 38452 38454 38458 38459 38464 38472 38473 38474 38482 38483 38484 38487 38672 38678 38682 38694 38695 38696 38697 38699 38706 38891 38901 38902 38924 38925 39110 39111 39121 39143 39144 39331 39338 39340 39362 39560 39561 39580 39581 39765 39768 39780 39781 39782 39783 39799 39998 40001 40002 40003 40004 40016 40017 40223 40225 40226 40227 40228 40229 40230 40231 40232 40233 40234 40423 40639 40858 40860 40891 40892 41077 41078 41097 41098 41099 41100 41101 41102 41103 41104 41105 41106 41107 41108 41109 41295 41296 41297 41309 41310 41311 41312 41313 41314 41316 41317 41515 41516 41517 41518 41519 41520 41521 41522 41523 41524 41525 41526 41527 41530 41740 41744 ];
backgroundInd = [132 567 568 727 785 945 1002 1003 1220 1381 1437 1599 1817 1872 2035 2090 2253 2307 2471 2525 2689 2742 2906 2960 3123 3178 3341 3558 3613 3774 3775 3830 3831 3991 4048 4207 4208 4265 4425 4483 4642 4701 4859 4919 5076 5136 5294 5510 5511 5571 5788 5945 6163 6223 6380 6440 6597 6598 6814 6815 6875 7032 7093 7249 7250 7310 7467 7528 7684 7685 7745 7746 7902 7963 8120 8181 8338 8398 8555 8616 8773 8833 8834 8990 8991 9051 9208 9269 9425 9487 9643 9704 9859 9860 9922 10076 10077 10140 10293 10358 10509 10510 10576 10725 10726 10727 10793 10794 10943 11011 11160 11228 11229 11378 11446 11595 11664 11812 11881 11882 12029 12030 12099 12246 12247 12316 12464 12534 12680 12681 12751 12752 12897 12969 13114 13186 13187 13331 13404 13549 13622 13766 13840 13983 14058 14199 14200 14415 14416 14493 14632 14633 14711 14850 15067 15146 15285 15502 15720 15799 15937 16017 16155 16373 16452 16591 16670 16839 16840 16841 16888 17055 17056 17059 17105 17273 17277 17323 17463 17489 17490 17495 17681 17706 17713 17759 17923 17932 17976 18117 18140 18150 18335 18357 18358 18369 18412 18553 18575 18588 18629 18771 18793 18806 18846 18847 18989 19011 19024 19025 19064 19207 19229 19243 19282 19425 19447 19461 19462 19499 19643 19665 19680 19681 19717 19861 19862 19883 19899 19900 19901 19914 19915 19916 19934 19935 20080 20101 20119 20120 20121 20130 20131 20132 20134 20152 20298 20319 20341 20342 20344 20345 20346 20347 20352 20370 20516 20537 20570 20588 20734 20755 20756 20788 20806 20953 20974 21006 21024 21171 21192 21224 21242 21389 21410 21441 21460 21461 21607 21608 21628 21659 21679 21826 21846 21877 21897 22044 22095 22115 22262 22282 22313 22334 22480 22501 22531 22552 22698 22719 22749 22770 22916 22937 22967 22988 22989 23134 23155 23207 23352 23373 23403 23425 23570 23591 23621 23644 23788 23809 23839 23862 24006 24027 24058 24080 24224 24245 24276 24298 24299 24442 24463 24494 24517 24660 24681 24712 24713 24735 24878 24899 24930 24931 24954 25096 25117 25143 25144 25145 25146 25147 25148 25172 25314 25335 25355 25356 25357 25358 25359 25360 25390 25532 25553 25571 25572 25573 25608 25750 25771 25789 25826 25827 25968 25989 26007 26045 26186 26207 26225 26263 26404 26425 26442 26443 26481 26622 26643 26660 26699 26840 26861 26878 26917 27058 27079 27096 27135 27297 27314 27354 27515 27531 27532 27573 27733 27749 27791 27951 27952 27967 28009 28010 28011 28012 28013 28014 28148 28170 28185 28232 28233 28234 28235 28388 28389 28403 28453 28454 28607 28608 28672 28673 28826 28838 28839 28891 28892 29044 29056 29110 29111 29263 29274 29329 29481 29482 29483 29492 29548 29702 29703 29704 29705 29706 29708 29709 29766 29927 29984 29985 30203 30421 30639 30858 30982 31076 31295 31513 31636 31731 31854 31949 32167 32168 32386 32604 32822 32945 32946 33040 33258 33476 33605 33694 33827 33912 34045 34046 34130 34348 34488 34489 34566 34784 35002 35220 35221 35365 35366 35439 35584 35658 35803 35804 35876 36095 36313 36314 36461 36532 36533 36680 36751 36899 36970 37117 37118 37119 37189 37190 37337 37408 37555 37556 37627 37774 37775 37845 37846 37993 38064 38212 38213 38283 38431 38432 38501 38650 38720 38869 38938 39087 39156 39157 39375 39594 39812 39963 40031 40181 40182 40249 40400 40401 40467 40468 40619 40620 40686 40838 40904 41057 41123 41275 41276 41341 41494 41559 41713 41778 41932 41996 42150 42214 42215 42369 42433 42587 42651 42806 42869 43024 43025 43088 43243 43306 43461 43462 43524 43680 43743 43898 43899 43961 44179 44336 44554 44615 44616 44773 44991 44992 45052 45210 45428 45429 45489 45647 45866 45926 46084 46085 46144 46303 46362 46363 46521 46522 46581 46740 46799 46959 ];
L = superpixels(X,337,'IsInputLab',true);

% Convert L*a*b* range to [0 1]
scaledX = prepLab(X);
BW = lazysnapping(scaledX,L,foregroundInd,backgroundInd);

% Create masked image.
maskedImage = RGB;
maskedImage(repmat(~BW,[1 1 3])) = 0;
end

function out = prepLab(in)

% Convert L*a*b* image to range [0,1]
out = in;
out(:,:,1) = in(:,:,1) / 100;  % L range is [0 100].
out(:,:,2) = (in(:,:,2) + 86.1827) / 184.4170;  % a* range is [-86.1827,98.2343].
out(:,:,3) = (in(:,:,3) + 107.8602) / 202.3382;  % b* range is [-107.8602,94.4780].

end
